<div class="suggestion">
  <div class="headerTitle">
    <h3>الاقتراحات</h3>
    <button class="btn" (click)="openPopup()">اضافة اقتراح <i class="fa-solid fa-plus"></i></button>
  </div>

  <div class="post-container mt-4">
    @for (card of SuggestionList(); track card.id) {
    <div class="post-card">
      <div class="header" (click)="toggleCard(card.id)">
        <div class="title w-75">
          <h5 class="m-0">{{card.title}}</h5>
          <p class="author ">{{ card.description }}</p>
        </div>
        <div class="date">
          <img src="Icons/stash_data-date-light.svg" alt="">
          <span> {{card.createdOn | date }}</span>

          <button class="toggle-btn">
            <i [class]="
                expandedCard === card.id ? 'fa-solid fa-chevron-up' : 'fa-solid fa-chevron-down'
              "></i>
          </button>
        </div>
      </div>
        <div class="iconsEy"> 
                        @if (card.viewed ) {
                          <img src="Icons/view.svg" alt="">
                        }
                        @else {
                          <img src="Icons/unview.svg" alt="">

                        }

                      </div>
      <div class="content" [class.open]="expandedCard === card.id">
        <div class="d-flex mb-4 justify-content-between align-items-start">
          <div class="images" *ngIf="card.photoUrls.length">
            <img *ngFor="let img of card.photoUrls" [src]="baseurl + img" alt="preview" />
          </div>
          <div class="voice-player" *ngIf="card.voiceNoteUrl">
            <button class="play-btn" (click)="togglePlay(card)">
              <i [class]="card.isPlaying ? 'fa-solid fa-pause' : 'fa-solid fa-play'"></i>
            </button>

            <div class="waveform">
              <div class="bar" *ngFor="let bar of [].constructor(40); let i = index"
                [style.height.px]="(Math.sin(i) * 10) + 20"
                [style.opacity]="(i / 40) < ((card.progress ?? 0) / 100) ? '1' : '0.3'">
              </div>
            </div>

            <span class="time">{{ formatTime(card.currentTime || 0) }}</span>
          </div>
        </div>
        <div class="resources" *ngIf="card.fileUrls.length">
          <div class="resource gap-2" *ngFor="let res of card.fileUrls ; let i = index">
            <img src="Icons/pdf.svg" alt="">
            <div>
              <h6> resource {{ i +1 }} <span>(pdf)</span></h6>
              <p>1 MB</p>
            </div>
          </div>
        </div>
      </div>
    </div>
    }
  </div>
</div>